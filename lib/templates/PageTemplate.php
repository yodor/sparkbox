<?php
include_once("components/Container.php");
include_once("components/BeanFormEditor.php");

include_once("class/pages/AdminPage.php");

abstract class PageTemplate extends Container
{
    protected SparkPage $page;
    protected $view;

    protected $request_condition;

    public function __construct()
    {
        parent::__construct();

        $this->initPage();

        $this->initPageActions();
    }

    abstract protected function initPage();

    abstract protected function initPageActions();

    abstract public function initView();

    public function processInput()
    {

    }

    public function startRender(): void
    {
        if (!$this->view) $this->initView();

        $this->processInput();

        $this->page->startRender();

        parent::startRender(); // TODO: Change the autogenerated stub
    }

    public function finishRender(): void
    {
        parent::finishRender(); // TODO: Change the autogenerated stub

        $this->page->finishRender();
    }

    public function setRequestCondition(RequestParameterCondition $request_condition)
    {
        $this->request_condition = $request_condition;
        foreach ($this->request_condition->getParameterNames() as $idx=>$name) {
            $this->page->addParameterName($name);
        }
    }

    public function getRequestCondition() : RequestParameterCondition
    {
        return $this->request_condition;
    }

    public function getPage() : SparkPage
    {
        return $this->page;
    }

}